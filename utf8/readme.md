# UTF8

UTF8 æ˜¯ä¸€ç§å…¼å®¹ ASCII ç¼–ç çš„å˜é•¿ç¼–ç ã€‚

## UTF8ç¼–ç çš„ç»†èŠ‚ï¼š

| Bytes count | Bits | Range               | Bytes                                 |
|-------------|------|---------------------|---------------------------------------|
|      1      |  7   | U+0000 - U+007F     | 0xxxxxxx                              |
|      2      |  11  | U+0080 - U+07FF     | 110xxxxx 10xxxxxx                     |
|      3      |  16  | U+0800	- U+FFFF     | 1110xxxx 10xxxxxx 10xxxxxx            |
|      4      |  21  | U+10000 - U+10FFFF  | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx   |

### æ ·ä¾‹

| Character	| Octal   |	Binary code point             | Binary UTF-8                               |
|-----------|---------|-------------------------------|--------------------------------------------|
| $ U+0024  | 044     | 010 0100                      | 0-0100100                                  |
| Â¢ U+00A2  | 0242    | 000 10-10 0010                | 110-00010 10-100010                        |
| â‚¬ U+20AC  | 020254  | 0010 -0000 10-10 1100         | 1110-0010 10-000010 10-101100              |
| ğˆ U+10348 | 0201510 | 0 00-01 0000 -0011 01-00 1000 | 11110-000 10-010000 10-001101 10-001000    |

## ç¼–ç 

  å³å°† Unicode codepoint è½¬æ¢ä¸ºç¬¦åˆ UTF8 ç¼–ç çš„å­—èŠ‚ã€‚

  å·²çŸ¥ä¸€ä¸ªå­—ç¬¦çš„Unicode Codepointæ˜¯ nï¼Œæ±‚å…¶UTF8å‚¨å­˜çš„å­—èŠ‚ã€‚

  ```rust
  fn encode(codepoint: u64) -> Vec<u8>
  ```

  äºŒè¿›åˆ¶è½¬æ¢åŸºæœ¬è¡¨æ ¼ï¼š

|  å­—èŠ‚ç±»å‹   |                         ç¼–ç                                |
|-----------|-----------------------------------------------------------|
| 10xxxxxx  | 2^7 + ... = 128 + n (n >= 0 && n <= 63)                   |
| 110xxxxx  | 2^7 + 2^6 + ... = 192 + n (n >= 0 && n <= 31)             |
| 1110xxxx  | 2^7 + 2^6 + 2^5 + ... = 224 + n (n >= 0 && n <= 15)       |
| 11110xxx  | 2^7 + 2^6 + 2^5 + 2^4 + ... = 240 + n (n >= 0 && n <= 7)  |

  å…·ä½“çš„ç®—æ³•å‚ç…§æºä»£ç ï¼š[encode.ts](./code/typescript/encode.ts) æˆ– [encode.cpp](./code/cpp/include/encode.h)ã€‚

## è§£ç¢¼

  å·²çŸ¥ä¸€åºåˆ—çš„UTF8äºŒè¿›åˆ¶ç ï¼Œå°†å…¶è§£ç ä¸ºUnicode codepointã€‚

  ```rust
  fn decode(stream: Vec<u8>) -> Vec<u64>
  ```

  å…·ä½“ç®—æ³•å‚ç…§æºä»£ç ï¼š[decode.cpp](./code/cpp/include/decode.h)

## é™„å½•/Appendix

  - [Wikipedia - UTF8](https://en.wikipedia.org/wiki/UTF-8)
